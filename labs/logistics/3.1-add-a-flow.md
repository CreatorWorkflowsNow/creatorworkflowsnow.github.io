---
id: 3.1-add-a-flow
title: "3.1 Add a Flow"
hide_table_of_contents: true
draft: false
---

## Overview 

While our users may be happy simply being able to track and manage their shipments on the Now Platform, as Creators we know this is only the beginning of the value we can provide. In this section, we will create an automated flow to connect to the tracking APIs of the various carriers used by our logistics team to update in near real-time the status of all our pending shipments.  We will also automate actions that occur when shipment statuses are updated to ensure we remain responsive to our customer’s demands.

## Instructions

1.	Navigate to App Engine Studio and open the App Home tab for your Logistics application.


2.	In the Automation section, click the Add a process or third-party integration link. From the Add Automation Screen, we are provided with a variety of process automation templates we can use to speed creation of common activities.


3.	Click Build from scratch to open a new custom flow.

4.	On the Flow Designer configuration screen, set the core attributes of our new automation flow.

5.	Set the name to Track Shipments

6.	Set Description to An automated process to connect to our logistics carriers and update the status of pending shipments.

7.	Once complete Click Continue

App Engine Studio will now create your Flow based on the options you selected. Once complete, you will see the Success confirmation screen.

We will want to specify the activities to
included in this flow, so click the Edit this flow button to begin the configuration process.

8.	This opens Flow Designer to the Track Shipments process just created. Since this is the first time we’ve launched Flow Designer, we’re given the opportunity to go through the Flow Designer product tour.

Let’s skip the tour for now, by clicking the Skip tour button.

9.	Now we have a blank Flow Designer canvas to start creating our process.
 

Our first task is to decide how this flow will be triggered. Common triggers include record creation or updates; REST Events; SLA Events; Catalog Events; or Inbound Email. In this case, we want the status of our shipments to   be updated regularly, even when no other internal or external event occurs. To enable this, we’ll choose one of the Date options.

10.	Click the Add a Trigger link and Select Repeat
under the Date heading.

11.	Next, we set the frequency with which we wish this flow to be triggered. We’ll start with every 3 hours to provide near real-time updates on shipments.

Set the values as follows:
Days: 0
Hours: 3
Minutes: 0
Seconds: 0


Once these values are set, click the Done button.

12.	The next step is to define the specific process that will occur every 3 hours. We do this through a combination of Actions, Flow Logic, and Subflows.

Add the first action to your Flow by clicking the Add an Action link, then clicking the Action button.

 

This will display a list of the Actions available for use on your instance of the Now Platform.

The action list provides an extensive list of options provided both
by ServiceNow and by your own internal IT Team leveraging spokes from our IntegrationHub product. These actions are built to empower you, the Citizen Developer, to create powerful interactions with common platforms and your own internal systems of record.
 

Important Note:
Make sure you select Look Up Records and not Look Up Record for this
step or you won’t be able to complete the next step without changing.
 

If you are looking for a connection that does not appear on the list, it is possible that it just has not yet been enabled on your instance by your Platform Owner. For a list of the prebuilt spokes and their actions offered by ServiceNow, check out the ServiceNow Store.


In this Flow, we’ll need to start by accessing our shipment data. We do this with the ServiceNow Core Spoke.

13.	Click ServiceNow Core from the spoke list.

14.	Click the action Look Up Records from the action list.
 

15.	Click the table field

16.	Type Shipments in the field. The list of tables will filter as you type.

17.	Select our table name Shipments [x_snc_logistics_shipments] from the list

18.	Next, we want to decide which records we want to update. Since shipments that have already been delivered are not likely to have updates, it makes sense to filter them from the actions of this Flow.

Select the choose field drop-down under Conditions and select the value Status.

19.	Update the Operator field from is to is one of.

20.	Then, select the status values of New and In Transit.

21.	Click Done.
 

22.	Now that we have a collection of records, we can tell the system what we want to do with them. The records are available in a data pill on the right side of the screen called Shipments Records.

Now we can walk through the records and check the current status of each. Start by adding a new step, but this time instead of Action, click Flow Logic.

23.	Then, select the For Each flow logic operator.

24.	Drag the data pill Shipments Records under 1 – Look Up Records into the Items selector to tell the system we want to process each of the identified shipment records.

25.	Click Done.

26.	Now we have a second activity stream under the For Each Item in action.  It is represented by a step directly under the For Each Flow Logic. This is an activity loop that will be performed for each item in the shipment record set.

Let’s add an action to that loop by clicking the Flow Logic button under the For Each loop.

This time we’ll select the If operator.

27.	Now we can evaluate information about each shipment record and do something different based on the value. In this case, we want to look up the status with the appropriate carrier depending on which carrier was used for the shipment.


We’ll step through these one by one starting with FedEx. First, check to see if the current record is for a FedEx shipment by creating a condition that evaluates the carrier field. Click the Data Pill Picker button for Condition 1.

28.	In the popup that appears, select the 2-For Each Collection.

29.	Then click the > next to Shipments Record to expand that record
 

30.	Finally, click Carrier to select that field for the condition.

31.	Leave the default operator is selected and under the data selector click FedEx to filter records that meet this criterion.

32.	Click Done

33.	Now, we can create an action that will only occur on records that are shipped through the FedEx Carrier. Under the If Flow Logic control, click Action.

34.	For this action, we’ll be using a custom IntegrationHub spoke. Search the action list for the spoke named FedEx. Click FedEx then select the Track Shipment action under this spoke.

35.	The Track Shipment is a custom spoke that leverages our company’s FedEx account information to connect to the public FedEx API and return information about a shipment. Because our IT team has already set this spoke up to use our FedEx connection information, the only thing we need to provide is the tracking number we wish to lookup. Fortunately, we have this information stored on the Shipment record and easily provide it.

Click the Data Pill Picker next to the Tracking Number field.

36.	In the popup that appears, select the 2-For Each Collection.

37.	Then click the > next to Shipments Record to expand that record

38.	Next click the Tracking Number field to provide that value to our FedEx spoke.

39.	Click Done.

Now, as the records are processed, each time a record has the carrier FedEx, the spoke will be activated to call the FedEx API passing the Tracking Number for that record. The response back from FedEx will be available in the data collection 4 – Track Shipment. We can see what information will be returned by scrolling down on the right and opening the 4 – Track Shipment collection. Here we see Current Status and Expected Delivery Date  for this shipment are returned.
 

40.	Since we now have an updated status and delivery date for this shipment, let’s update the record on
the Now Platform.


Add an action under the If Flow Control Logic by clicking the + icon under the FedEx spoke connection.

41.	Select Action

42.	Select ServiceNow Core

43.	Select Update Record

44.	Next, we need to tell Flow Designer which record we wish to update. To do this, either use the Data Pill Picker again, or simply drag the Shipments Record data pill under 2 – For Each on the right side into the Record field.

Once the record is selected, the table will automatically be set to the Shipments table.

45.	Now let’s tell Flow Designer which fields to update. Click the Add field value button.

46.	A Fields drop-down will appear.  Select the field Status from the drop-down.

47.	Next, we’ll update with the data we received from FedEx. Click the Data Pill Picker button.

48.	Click 4 – Track Shipment

49.	Click Current Status

Now, let’s do the same for the updated delivery date information.

50.	Click the Add field value button under the Status field.

51.	Choose Deliver Date from the drop-down.

52.	Click the Data Pill Picker button next to Deliver Date

53.	Click 4 – Track Shipment
 

54.	Click Expected Delivery Date

Once complete, your action should look similar to the image below.
55.	Click Done

Congratulations, you now have a Flow that automatically connects to FedEx and updates shipment status information for undelivered shipments every three hours. Now let’s keep going to add status checks for UPS and DHL as well.

56.	Moving straight down from the If Flow Logic in the previous step, let’s add a check for UPS. Make sure you are extending the right process thread. If you continue the process under the FedEx thread, your UPS check will not run.  

Remember, in that thread we’ve only selected Shipment Records where the carrier is FedEx, so a subsequent check to see if the carrier is UPS would always be negative.

Click the + link directly below the previous If as shown in the image.

57.	Click the Flow Logic button and select Else If

58.	Click the Data Pill Picker button for Condition 1.

59.	In the popup that appears, select the 2-For Each Collection.
 


60.	Then click the > next to Shipments Record to expand that record

61.	Finally, click Carrier to select that field for the condition.

62.	Leave the default operator is
selected and under the data selector click UPS to filter records that meet this criterion.

63.	Click Done

64.	Under the Else If Flow Logic, click the Action button.

65.	Select the UPS Spoke and select the Track Shipment action.

66.	Click the Data Pill Picker next to the Tracking Number field.

67.	In the popup that appears, select the 2-For Each Collection.

68.	Then click the > next to Shipments Record to expand that record

69.	Next click the Tracking Number field to provide that value to our UPS spoke.

70.	Click Done.

71.	Adding to the thread under the UPS Spoke, click + then Select Action

72.	Select ServiceNow Core

73.	Select Update Record
 

74.	Next, we need to tell Flow Designer which record we wish to update. To do this, either use the Data Pill Picker
again, or simply drag the Shipments Record data pill under 2 – For Each on the right side into the Record field.

Once the record is selected, the table will automatically be set to the Shipments table.

75.	Click the Add field value button.

76.	A Fields drop-down will appear.  Select the field Status from the drop-down.

77.	Next, we’ll update with the data we received
from FedEx.

Click the Data Pill Picker button.

78.	Click 7 – Track Shipment

79.	Click Current Status

Now, let’s do the same for the updated delivery
date information.

80.	Click the Add field value button under the Status field.

81.	Choose Deliver Date from the drop-down.

82.	Click the Data Pill Picker button next to Deliver Date

83.	Click 7 – Track Shipment

84.	Click Expected Delivery Date

85.	Click Done

Assuming all has gone well, your Flow should look like the one pictured here.
Now, let’s see if you can do the next one on your
own.


86.	Starting with step 56, try and recreate the same sequence for the carrier DHL on your own.
 


87.	Click Save

88.	Click Activate then confirm by clicking Activate on the confirmation popup screen.

If all goes well, your flow should look like the image below when complete.

## Exercise recap

Congratulations! You’ve built an automated flow that updates all pending shipments every three hours. Next, let’s test our work and see it in action.